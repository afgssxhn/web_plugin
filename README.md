# Web Plugin

Плагин для Purpur/Paper, который показывает список онлайн игроков и информацию о сервере.

## Возможности

### Команда `/webp` (Online Players)
- Показывает список онлайн игроков в правильном порядке
- Отображает: ник, страну (по IP), пинг
- Цветовая индикация пинга (настраивается в config.yml)
- Автоопределение локальных подключений
- **Кэширование GeoIP** для быстрой работы и снижения нагрузки на API
- Асинхронная загрузка данных без лагов сервера

### Команда `/webe` (Server Equipment)
- Показывает характеристики сервера
- Отображает: OS, архитектуру, CPU (название и количество ядер), загрузку CPU, RAM, дисковое пространство, Java версию
- **Неблокирующий** расчет CPU usage (без Thread.sleep)
- Все метрики настраиваются в конфиге

### Команда `/webtps` (TPS Display)
- Переключает отображение TPS и MSPT в boss bar
- Показывает текущий TPS (Ticks Per Second) сервера
- Показывает MSPT (Milliseconds Per Tick) - время обработки одного тика
- Цветовая индикация производительности (зеленый/желтый/розовый/красный)
- Обновляется каждые 2 секунды (настраивается в config.yml)
- Индивидуальное отображение для каждого игрока

## Сборка

```bash
mvn clean package
```

Скомпилированный .jar будет в `target/Web-1.4.2.jar`

## Установка

1. Скопируй `Web-1.4.2.jar` в папку `plugins/` твоего сервера
2. Перезапусти сервер или используй `/reload confirm`
3. Настрой `plugins/Web/config.yml` под свои нужды (опционально)

## Использование

**Показать игроков:**
```
/webp
```
или `/web_players`

**Показать характеристики сервера:**
```
/webe
```
или `/web_equipment`

**Показать TPS сервера:**
```
/webtps
```
или `/web_tps`, `/wtps`

## Permissions (Разрешения)

```yaml
web.players      # Доступ к /webp (по умолчанию: все)
web.equipment    # Доступ к /webe (по умолчанию: только операторы)
web.tps          # Доступ к /webtps (по умолчанию: только операторы)
web.*            # Все разрешения плагина
```

## Конфигурация

После первого запуска плагин создаст файл `plugins/Web/config.yml` со следующими настройками:

### GeoIP Settings
- `api-url` - API endpoint для геолокации
- `timeout` - таймаут соединения (мс)
- `cache-ttl` - время жизни кэша (секунды)
- `enabled` - включить/выключить GeoIP

### Цветовые пороги
- `ping-colors` - пороги для цветов пинга
- `cpu-colors` - пороги для цветов CPU usage

### Сообщения
Полностью настраиваемые сообщения с поддержкой цветовых кодов (`&c`, `&e`, и т.д.)

### Функции
- `show-country` - показывать страну
- `show-ping` - показывать пинг
- `show-cpu-usage` - показывать загрузку CPU
- `show-disk-space` - показывать дисковое пространство

Пример конфига см. в `src/main/resources/config.yml`

## Требования

- Purpur/Paper 1.21+ или выше
- Java 21

## API для GeoIP

Плагин использует бесплатный API `ipapi.co` для определения страны по IP.
Для локальных IP (127.0.0.1, 192.168.x.x, 10.x.x.x, 172.x.x.x) показывает "Local".

Результаты кэшируются на 24 часа (по умолчанию), что снижает количество запросов к API и ускоряет работу плагина.
